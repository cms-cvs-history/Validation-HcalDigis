process HcalMixing = {

   include "Configuration/StandardSequences/data/Simulation.cff"
   include "Configuration/StandardSequences/data/MixingLowLumiPileUp.cff"
   include "Configuration/StandardSequences/data/FakeConditions.cff"
   include "Configuration/StandardSequences/data/Reconstruction.cff"

  untracked PSet maxEvents = {untracked int32 input = 1000}

  service = MessageLogger { }
  service = SimpleMemoryCheck{ }
  service = DaqMonitorROOTBackEnd{ }
  service = RandomNumberGeneratorService {
            untracked uint32 sourceSeed = 135799753
            PSet moduleSeeds =
            {
#              untracked uint32 VtxSmeared = 98765432
#              untracked uint32 g4SimHits  = 11
              untracked uint32 mix        = 12345
              untracked uint32 ecalUnsuppressedDigis = 43434
              untracked uint32 hcalUnsuppressedDigis = 43434
      }
  }


   source = PoolSource
   {
     untracked vstring fileNames = {'file:/afs/cern.ch/cms/data/CMSSW/Validation/HcalDigis/data/simhits_pi+100_etaphi44.root'}
     untracked uint32 debugVebosity = 10
     untracked bool   debugFlag     = true
   }



# ECAL is included in CalDigi, so minimize required resources
  replace ecalUnsuppressedDigis.doNoise = false
  replace ecalUnsuppressedDigis.doESNoise = false

##-- Mixing Module (for pileup simulation)

  replace mix.input.fileNames = {'file:/afs/cern.ch/cms/data/CMSSW/Validation/HcalDigis/data/simhits_pi+100_etaphi44.root'}
  replace mix.input.minBunch = -5
  replace mix.input.maxBunch = 3
  replace mix.input.nbPileupEvents= {double averageNumber=1}

##-- digitization

  sequence caloDigi = { mix, calDigi }

  module hcalDigiAnalyzer = HcalDigiTester{
        untracked string outputFile = 'histo_HB_poisson.root'
        untracked string hcalselector   = 'HB'
        untracked bool subpedvalue      = true
        InputTag digiLabel = hcalUnsuppressedDigis
  }

path p = {caloDigi, hcalDigiAnalyzer}

  }		
