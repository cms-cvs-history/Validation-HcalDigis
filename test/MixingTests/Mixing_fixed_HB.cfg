process HcalMixing = {

   include "Configuration/StandardSequences/data/SimulationRandomNumberGeneratorSeeds.cff"
   include "Configuration/StandardSequences/data/Simulation.cff"
   include "Configuration/StandardSequences/data/MixingLowLumiPileUp.cff"
   include "Configuration/StandardSequences/data/FakeConditions.cff"
   include "Configuration/StandardSequences/data/Reconstruction.cff"

  untracked PSet maxEvents = {untracked int32 input = 1000}

  service = MessageLogger { }
  service = SimpleMemoryCheck{ }
  service = DaqMonitorROOTBackEnd{ }

   source = PoolSource
   {
     untracked vstring fileNames = {'file:/afs/cern.ch/cms/data/CMSSW/Validation/HcalDigis/data/1_8_0/simhits_pi+100_etaphi44.root'}
     untracked uint32 debugVebosity = 10
     untracked bool   debugFlag     = true
   }


# ECAL is included in CalDigi, so minimize required resources
  replace ecalUnsuppressedDigis.doNoise = false
  replace ecalUnsuppressedDigis.doESNoise = false

##-- Mixing Module (for pileup simulation)

  replace mix.fileNames = {'file:/afs/cern.ch/cms/data/CMSSW/Validation/HcalDigis/data/1_8_0/simhits_pi+100_etaphi44.root'}
  replace mix.type = "fixed"
  replace mix.minBunch = -5
  replace mix.maxBunch = 3
  replace mix.nbPileupEvents= {double averageNumber=1}

##-- digitization

  sequence caloDigi = { mix, calDigi }

  module hcalDigiAnalyzer = HcalDigiTester{
        untracked string outputFile = 'histo_HB_fixed.root'
        untracked string hcalselector   = 'HB'
        untracked bool subpedvalue      = true
        InputTag digiLabel = hcalUnsuppressedDigis
  }

path p = {caloDigi, hcalDigiAnalyzer}

  }		
