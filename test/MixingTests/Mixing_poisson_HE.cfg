process HcalMixing = {

   include "Configuration/StandardSequences/data/SimulationRandomNumberGeneratorSeeds.cff"
   include "Configuration/StandardSequences/data/Simulation.cff"
   include "Configuration/StandardSequences/data/MixingLowLumiPileUp.cff"
   include "Configuration/StandardSequences/data/FakeConditions.cff"
   include "Configuration/StandardSequences/data/Reconstruction.cff"

  untracked PSet maxEvents = {untracked int32 input = 1000}

  service = MessageLogger { }
  service = SimpleMemoryCheck{ }
  service = DaqMonitorROOTBackEnd{ }

   source = PoolSource
   {
     untracked vstring fileNames = {'file:/afs/cern.ch/cms/data/CMSSW/Validation/HcalDigis/data/1_8_0/simhits_pi+100_etaphi244.root'}
     untracked uint32 debugVebosity = 10
     untracked bool   debugFlag     = true
   }


  include "Geometry/CMSCommonData/data/cmsIdealGeometryXML.cfi"

# ECAL is included in CalDigi, so minimize required resources
  replace ecalUnsuppressedDigis.doNoise = false
  replace ecalUnsuppressedDigis.doESNoise = false

##-- Mixing Module (for pileup simulation)

  replace mix.fileNames = {'file:/afs/cern.ch/cms/data/CMSSW/Validation/HcalDigis/data/1_8_0/simhits_pi+100_etaphi244.root'}
  replace mix.minBunch = -5
  replace mix.maxBunch = 3
  replace mix.nbPileupEvents= {double averageNumber=1}

##-- digitization

  sequence caloDigi = { mix, calDigi }

  module hcalDigiAnalyzer = HcalDigiTester{
        untracked string outputFile = 'histo_HE_poisson.root'
        untracked string hcalselector   = 'HE'
        untracked bool subpedvalue      = false
        InputTag digiLabel              = hcalUnsuppressedDigis
  }

path p = {caloDigi, hcalDigiAnalyzer}

  }		
